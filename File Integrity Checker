import hashlib
import os

def calculate_sha256(file_path):
    #Calculates the SHA-256 hash of a file to create a unique digital fingerprint.
    
    sha256_hash = hashlib.sha256()
    
    try:
        # Reading in 'rb' (Binary Mode) is important for all file types (images, exe, etc.)
        with open(file_path, "rb") as f:
            # Read file in chunks to handle large files without crashing RAM
            for byte_block in iter(lambda: f.read(4096), b""):
                sha256_hash.update(byte_block)
        return sha256_hash.hexdigest()
    except FileNotFoundError:
        return None

def verify_integrity(file_path, original_hash):
    #Compares the current file hash with the original recorded hash.
    
    print(f"\n{'='*50}")
    print(f"  FILE INTEGRITY CHECK: {os.path.basename(file_path)}")
    print(f"{'='*50}")

    current_hash = calculate_sha256(file_path)

    if current_hash is None:
        print("Error: File not found.")
        return

    print(f"Original Hash: {original_hash}")
    print(f"Current Hash:  {current_hash}")

    if current_hash == original_hash:
        print("\n VERDICT: File is INTACT. No changes detected.")
    else:
        print("\n WARNING: File has been ALTERED! (Tampering Detected)")
    
    print(f"{'='*50}\n")

if __name__ == "__main__":
    # 1. Let's create a test file
    filename = "secret_data.txt"
    with open(filename, "w") as f:
        f.write("This is highly confidential information.")

    # 2. Generate and Record the "Safe" Hash
    original_fingerprint = calculate_sha256(filename)
    print(f"Initial Setup: Recorded Hash for {filename}")

    # 3. Simulate Checking the file (Normal)
    verify_integrity(filename, original_fingerprint)

    # 4. Simulate a Hacker changing the file
    print("... A hacker modifies the file ...")
    with open(filename, "a") as f:
        f.write(" ") # Just adding a single space!

    # 5. Verify again after tampering
    verify_integrity(filename, original_fingerprint)